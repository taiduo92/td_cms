(function(t){function e(e){for(var a,s,o=e[0],c=e[1],l=e[2],p=0,h=[];p<o.length;p++)s=o[p],n[s]&&h.push(n[s][0]),n[s]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(h.length)h.shift()();return i.push.apply(i,l||[]),r()}function r(){for(var t,e=0;e<i.length;e++){for(var r=i[e],a=!0,o=1;o<r.length;o++){var c=r[o];0!==n[c]&&(a=!1)}a&&(i.splice(e--,1),t=s(s.s=r[0]))}return t}var a={},n={app:0},i=[];function s(e){if(a[e])return a[e].exports;var r=a[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=t,s.c=a,s.d=function(t,e,r){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)s.d(r,a,function(e){return t[e]}.bind(null,a));return r},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/td_cms.github.io/dist/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var u=c;i.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"034f":function(t,e,r){"use strict";var a=r("64a9"),n=r.n(a);n.a},"0514":function(t,e,r){},"056b":function(t,e,r){},"120d":function(t,e,r){"use strict";var a=r("d25d"),n=r.n(a);n.a},"155c":function(t,e,r){"use strict";var a=r("056b"),n=r.n(a);n.a},"17cc":function(t,e,r){"use strict";var a=r("d15b"),n=r.n(a);n.a},"269d":function(t,e,r){},"301c":function(t,e,r){t.exports=r.p+"img/banner.54784f9f.jpg"},4516:function(t,e,r){},"4b2c":function(t,e,r){t.exports=r.p+"img/gan.9a909373.png"},"50ae":function(t,e,r){"use strict";var a=r("56b2"),n=r.n(a);n.a},"56b2":function(t,e,r){},"56d7":function(t,e,r){"use strict";r.r(e);r("cadf"),r("551c"),r("097d");var a=r("2b0e"),n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"app"}},[r("div",{staticClass:"app_menu",on:{click:t.fn_routeActive}},[r("el-menu",{staticClass:"el-menu-demo",attrs:{mode:"horizontal","default-active":t.activeRouter,"active-text-color":"#E6A23C","background-color":"#409EFF","text-color":"#fff"}},[r("el-menu-item",{attrs:{index:"/"}},[r("router-link",{attrs:{tag:"div",to:"/"}},[t._v("主页")])],1),r("el-menu-item",{attrs:{index:"mx"}},[r("router-link",{attrs:{tag:"div",to:"/mx"}},[t._v("木夕数据恢复")])],1),r("el-menu-item",{attrs:{index:"mxCreate"}},[r("router-link",{attrs:{tag:"div",to:"/mxCreate"}},[t._v("木夕作品拷贝")])],1),r("el-menu-item",{attrs:{index:"mxTest"}},[r("router-link",{attrs:{tag:"div",to:"/mxTest"}},[t._v("木夕工具测试")])],1),r("el-menu-item",{attrs:{index:"about"}},[r("router-link",{attrs:{tag:"div",to:"/about"}},[t._v("关于我们")])],1),r("el-menu-item",{directives:[{name:"show",rawName:"v-show",value:!t.loginState,expression:"!loginState"}],staticClass:"fr",attrs:{index:"login"}},[r("router-link",{attrs:{tag:"div",to:"login"}},[t._v("登陆")])],1),r("el-menu-item",{directives:[{name:"show",rawName:"v-show",value:t.loginState,expression:"loginState"}],staticClass:"fr",attrs:{index:"1"},on:{click:function(e){t.centerDialogVisible=!0}}},[t._v("退出登陆")])],1),r("el-select",{staticClass:"selectOption",attrs:{placeholder:"请选择"},on:{change:t.fn_checkVerion},model:{value:t.versionOption,callback:function(e){t.versionOption=e},expression:"versionOption"}},t._l(t.versionItem,function(t){return r("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),r("el-dialog",{attrs:{title:"提示",visible:t.centerDialogVisible,width:"30%",center:""},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[r("span",[t._v("确定退出登陆吗？")]),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){t.centerDialogVisible=!1}}},[t._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:t.exitLogin}},[t._v("确 定")])],1)]),r("div",{staticClass:"v_wrapper"},[r("router-view")],1)],1)},i=[],s=(r("a481"),r("28a5"),r("cebc")),o=r("2f62"),c={name:"app",created:function(){this.init()},computed:Object(s["a"])({loginState:function(){return this.$store.getters.getLoginState}},Object(o["b"])(["getApiVersion"])),data:function(){return{centerDialogVisible:!1,activeRouter:"login",versionItem:[{value:"online",label:"正式环境"},{value:"test",label:"测试环境"}],versionOption:"test"}},methods:Object(s["a"])({init:function(){this.initData(),this.initFn()},initData:function(){this.versionOption=this.getApiVersion},initFn:function(){this.fn_routeActive()},fn_routeActive:function(){this.activeRouter=this.$route.path.split("/")[1]?this.$route.path.split("/")[1]:"/"}},Object(o["c"])(["setApiVersion","setStNextRouter"]),{fn_checkVerion:function(t){var e=this.$route.path?this.$route.path:"/";this.setApiVersion(t),this.setStNextRouter(e),this.exitLogin("no")},exitLogin:function(t){this.centerDialogVisible=!1,this.$store.commit("setLoginState",!1),t||this.$message("退出登陆成功"),this.$router.replace("/login")}}),updated:function(){this.initFn()}},l=c,u=(r("034f"),r("2877")),p=Object(u["a"])(l,n,i,!1,null,null,null);p.options.__file="App.vue";var h=p.exports,d=r("5c96"),f=r.n(d);r("0fae");a["default"].use(o["a"]);var m={isLogin:!1,mxToken:null,projectNumber:0,projectId:0,projectName:"作品名称",apiVersion:"test",st_nextRouter:"/"},_=function(){var t=window.localStorage.getItem("token");return!!t&&(m.mxToken=t,!0)},b=function(){var t=window.localStorage.getItem("mx_version");return!!t&&(m.apiVersion=t,!0)};b(),_()&&(m.isLogin=!0);var v=new o["a"].Store({state:m,getters:{getLoginState:function(t){return t.isLogin},getToken:function(t){return t.mxToken},getProjectNumber:function(t){return t.projectNumber},getProjectId:function(t){return t.projectId},getProjectName:function(t){return t.projectName},getApiVersion:function(t){return t.apiVersion},getStNextRouter:function(t){return t.st_nextRouter}},mutations:{setLoginState:function(t,e){t.isLogin=e,t.mxToken=e,window.localStorage.setItem("token",e||"")},setProjectNumber:function(t,e){t.projectNumber=e},setProjectId:function(t,e){t.projectId=e},setProjectName:function(t,e){t.projectName=e},setApiVersion:function(t,e){t.apiVersion=e,window.localStorage.setItem("mx_version",e)},setStNextRouter:function(t,e){t.st_nextRouter=e,window.localStorage.setItem("mx_nextRouter",e)}}}),g=v,w=(r("7f7f"),r("8c4f")),x=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"v_index"},[r("el-carousel",{staticClass:"index-carousel",attrs:{interval:4e3,type:"always",height:"480px"}},t._l(t.bannerItem,function(t){return r("el-carousel-item",{key:t},[r("div",{staticClass:"carousel-background",style:{background:"url("+t+") center top / auto 100% no-repeat"}})])}),1),r("el-carousel",{staticClass:"index-carousel",attrs:{interval:4e3,type:"always",height:"480px"}},t._l(t.bannerItem,function(t){return r("el-carousel-item",{key:t},[r("div",{staticClass:"carousel-background",style:{background:"url("+t+") center top / auto 100% no-repeat"}})])}),1),r("el-carousel",{staticClass:"index-carousel",attrs:{interval:4e3,type:"always",height:"480px"}},t._l(t.bannerItem,function(t){return r("el-carousel-item",{key:t},[r("div",{staticClass:"carousel-background",style:{background:"url("+t+") center top / auto 100% no-repeat"}})])}),1)],1)},j=[],C={data:function(){return{bannerItem:[r("301c"),r("d15f"),r("db49")]}}},y=C,k=(r("ca3e"),Object(u["a"])(y,x,j,!1,null,"c016797e",null));k.options.__file="index.vue";var I=k.exports,N=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"V_login"}},[r("el-form",{staticClass:"demo-ruleForm",attrs:{"status-icon":"","label-width":"62px"}},[r("el-form-item",{attrs:{label:"用户名:"}},[r("el-input",{attrs:{placeholder:"请输入用户名",autocomplete:"off"},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}})],1),r("el-form-item",{attrs:{label:"密码:"}},[r("el-input",{attrs:{type:"password",placeholder:"请输入密码",autocomplete:"off"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),r("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm()}}},[t._v("登陆")])],1)],1)},P=[],S=r("f499"),L=r.n(S),F=r("795b"),O=r.n(F),D=r("bc3a"),R=r.n(D),q={dataRenewSuccess:"数据恢复成功",dataRenewFailure:"数据恢复失败",searchNull:"搜索内容不能为空",projectPublishNull:"此作品没有发布过",serviceUnusual:"服务器连接失败！",userPwdInexistence:"用户名密码不能为空",loginSuccess:"登录成功"},T={message:function(t){Object(d["Message"])(t)},success:function(t){Object(d["Message"])({message:t,type:"success"})},warning:function(t){Object(d["Message"])({message:t,type:"warning"})},error:function(t){d["Message"].error(t)}},M=function(t,e){var r=q[e]?q[e]:e;T[t]?T[t](r):T.warning("程序员 ！！！ 没有你想要的提示框？")},$=M,V=function(t){return new O.a(function(e,r){var a=R.a.create({headers:t.headers?t.headers:{"Content-Type":"application/json"}});a.interceptors.request.use(function(t){return t},function(t){r(err)}),a.interceptors.response.use(function(t){return t},function(t){r(t)}),t.isToken&&("post"==t.method?t.data.append("token",g.getters.getToken):-1!=t.url.indexOf("?")?t.url+="&token="+g.getters.getToken:t.url+="?token="+g.getters.getToken),a(t).then(function(a){-1==t.url.indexOf("/apitool/v1/web/opus/maker/structure/save_structures")||a.data.isOk||"3050"!=a.data.message.code?e({data:a.data}):($("error",a.data.message.title),r(!1))}).catch(function(t){r(t),console.log("接口请求错误",t)})})},z=V,E={mxapi:"//mxapi.cgyouxi.com",mxapi_test:"//test-mxapi.cgyouxi.com"},A={getPublishProject:"/resource/v3/project/",login:E.mxapi+"/apiuser/v1/web/user/login/common/login",queryProject:E.mxapi+"/community/v1/qingcheng/community/work/workinfo/get_work_info",saveStructures:E.mxapi+"/apitool/v1/web/opus/maker/structure/save_structures",getStructures:E.mxapi+"/apitool/v1/web/opus/maker/structure/get_structures"},B={getPublishProject:"/resource/v3/test-project/",login:E.mxapi_test+"/apiuser/v1/web/user/login/common/login",queryProject:E.mxapi_test+"/community/v1/qingcheng/community/work/workinfo/get_work_info",saveStructures:E.mxapi_test+"/apitool/v1/web/opus/maker/structure/save_structures",getStructures:E.mxapi_test+"/apitool/v1/web/opus/maker/structure/get_structures"},J=function(t){return"online"==g.getters.getApiVersion?A:B};function U(t,e){return z({method:"post",url:J().login+"?login_name=".concat(t,"&password=").concat(e)})}function H(t,e,r){return z({url:J().getPublishProject+"".concat(t,"/").concat(e,"/").concat(r)})}function W(t){var e=new FormData;return e.append("workName",t),z({url:J().queryProject,method:"post",data:e})}function G(t,e,r){e=-1!=L()(e).indexOf("[")?e:[e],r=-1!=L()(r).indexOf("[")&&L()(r).indexOf("[")<5?r:[r];var a=new FormData;return a.append("project_id",t),a.append("structure_name",L()(e)),a.append("structure_content",L()(r)),a.append("material_ver","v3"),z({url:J().saveStructures,method:"post",data:a,isToken:!0})}function Y(t,e){return z({url:J().getStructures+"?project_id=".concat(t,"&structure_name=").concat(e),isToken:!0})}var K={computed:Object(s["a"])({},Object(o["b"])(["getStNextRouter"])),data:function(){return{userName:"",password:""}},created:function(){this.init()},methods:{init:function(){this.initData()},initData:function(){0},submitForm:function(t){var e=this;""!=this.userName&&""!=this.password?this.requestLoginFn(function(t,r){e.ut_showMessage("success","loginSuccess"),e.storeLoginInfo(r),setTimeout(function(){e.$router.replace(e.getStNextRouter)},100)}):this.ut_showMessage("error","userPwdInexistence")},requestLoginFn:function(t){var e=this;U(this.userName,this.password).then(function(r){var a=r.data;a.isOk?t(a.isOk,a.token):e.ut_showMessage("error",a.message.title)}).catch(function(t){console.log("登陆失败,失败原因",t),e.ut_showMessage("error","serviceUnusual")})},storeLoginInfo:function(t){this.$store.commit("setLoginState",t)}}},Q=K,X=(r("ce21"),Object(u["a"])(Q,N,P,!1,null,"27d08ce3",null));X.options.__file="login.vue";var Z=X.exports,tt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"v_mx"},[r("div",{staticClass:"mx-showData-left"},[r("div",{staticClass:"mx-search"},[r("el-autocomplete",{staticClass:"input-with-select small-width",attrs:{"fetch-suggestions":t.queryProjectFn,placeholder:"请输入内容","trigger-on-focus":!1},on:{select:t.selectProjectFn},model:{value:t.queryProjectName,callback:function(e){t.queryProjectName=e},expression:"queryProjectName"}},[r("el-select",{attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:t.select,callback:function(e){t.select=e},expression:"select"}},[r("el-option",{attrs:{label:"作品名称",value:"2"}})],1),r("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.searchProjectFn},slot:"append"})],1)],1),r("el-tabs",{on:{"tab-click":t.handleClickFn},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},t._l(t.tabFileList,function(t){return r("el-tab-pane",{attrs:{label:t.label,name:t.name}})}),1),r("el-table",{staticStyle:{width:"100%"},attrs:{data:t.searchResult,sort:"order","default-sort":{prop:"version",order:"descending"},border:""}},[r("el-table-column",{attrs:{prop:"fileName",label:"文件名"}}),r("el-table-column",{attrs:{prop:"version",sortable:"",label:"发布版本号"}}),r("el-table-column",{attrs:{prop:"address",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{directives:[{name:"show",rawName:"v-show",value:"chapterinfo"==t.activeName,expression:"activeName == 'chapterinfo'"}],attrs:{size:"mini"},on:{click:function(r){t.previewChpaterListFn(e.$index,e.row)}}},[t._v("预览章节列表")]),r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(r){t.restoreDataFn(e.row)}}},[t._v("还原数据")])]}}])})],1)],1),r("router-view",{directives:[{name:"show",rawName:"v-show",value:"chapterinfo"==t.activeName,expression:"activeName == 'chapterinfo'"}]})],1)},et=[],rt=(r("ac6a"),r("5df3"),r("6b54"),{name:"mx",data:function(){return{queryProjectName:"",projectId:"",select:"作品名称",tabFileList:[{label:"基本信息文件",name:"workinfo"},{label:"静态资源文件",name:"filemap"},{label:"角色文件",name:"rolelist"},{label:"数值型",name:"values"},{label:"章节集合",name:"chapterinfo"}],activeName:"workinfo",searchResult:[],tempSearchResult:[],bin:{workInfo:"workinfo.bin",filemap:"filemap.bin",rolelist:"rolelist.bin",values:"values.bin",chapterList:"chapterinfo.bin"},binNumber:0,previewData:[]}},methods:Object(s["a"])({},Object(o["c"])(["setProjectNumber","setProjectId","setProjectName"]),{initData:function(){this.searchResult=[],this.tempSearchResult=[]},queryProjectFn:function(t,e){var r=this;if(t&&""!=t){var a=[];W(t).then(function(t){var r=t.data;r.isOk&&r.data&&r.data.length&&(a=r.data.map(function(t){return{value:t.work_name+"  ["+t.username+"]",projectId:t.project_id}})),e(a)},function(t){console.log("errr",t),r.ut_showMessage("error","服务器异常"),e(a)})}},selectProjectFn:function(t,e){this.projectId=t.projectId,this.binNumber=0,console.log("queryProjectId:"+this.projectId)},searchProjectFn:function(t){var e=this;this.checkSearchContentFn("message"),this.binNumber=0,this.initData(),this.setProjectId(this.projectId),this.getWorkInfoFn(function(){e.binNumber&&(e.setProjectNumber(e.binNumber),t&&"[object Function]"==Object.prototype.toString.call(t)?t():"workinfo"==e.activeName?e.searchResult=e.tempSearchResult:e.getFileFn())})},getWorkInfoFn:function(t){++this.binNumber,this.searchApiFn(this.bin["workInfo"],"getWorkInfoFn",t)},searchApiFn:function(t,e,r){var a=this;H(this.projectId,this.binNumber,t).then(function(t){a.tempSearchResult.push({fileName:"workinfo.bin",version:a.binNumber,data:t.data}),a[e](r),a.setProjectName(""!=t.data.work_name?t.data.work_name:a.queryProjectName)},function(t){--a.binNumber,r(!1),0==a.binNumber&&a.ut_showMessage("error","projectPublishNull"),console.log("失败原因",t)})},handleClickFn:function(){this.checkSearchContentFn()&&(this.binNumber>0?(this.initData(),this.getFileFn()):this.searchProjectFn(this.handleClickFn))},checkSearchContentFn:function(t){return!(""==this.queryProjectName||!this.queryProjectName)||("message"==t&&this.ut_showMessage("success","dataRenewSuccess"),!1)},getFileFn:function(){var t=this;if(this.binNumber){for(var e=[],r=this.activeName+".bin",a=1;a<=this.binNumber;a++)e.push(H(this.projectId,a,r));O.a.all(e).then(function(e){console.log("data=>>>>",e),t.searchResult=[],e.forEach(function(e,a){t.searchResult.push({fileName:r,version:a+1,data:e.data})})}).catch(function(t){console.log("获取失败",t)})}},previewChpaterListFn:function(t,e){console.log(t,e),this.previewData=e.data,this.$router.push({name:"chapterList",query:{id:Date.parse(new Date)},params:{data:e.data,version:e.version}})},restoreDataFn:function(t){var e=this;G(this.projectId,this.activeName+".bin",t.data).then(function(t){t.data.isOk?e.ut_showMessage("success","dataRenewSuccess"):e.ut_showMessage("error",t.data.message.context)},function(){}).catch(function(t){e.ut_showMessage("error","dataRenewFailure"),console.log("数据恢复失败原因",t)})}})}),at=rt,nt=(r("155c"),Object(u["a"])(at,tt,et,!1,null,null,null));nt.options.__file="mx.vue";var it=nt.exports,st=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"mx_create"},[r("div",{staticClass:"mx-create-center"},[r("div",{staticClass:"fl mx-create-center-left"},[r("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[r("el-form-item",{attrs:{label:"作品名称:"}},[r("el-autocomplete",{staticClass:"inline-input samll-width",attrs:{"fetch-suggestions":t.queryProjectFn,placeholder:"请输入内容","trigger-on-focus":!1},on:{select:function(e){t.selectProjectFn(e,"query")}},model:{value:t.queryProjectName,callback:function(e){t.queryProjectName=e},expression:"queryProjectName"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:t.queryChapterFn}},[t._v("查询")])],1)],1),r("el-table",{staticStyle:{width:"100%"},attrs:{data:t.chapterList,border:""}},[r("el-table-column",{attrs:{label:"章节名称",align:"center",prop:"chapterName"}}),r("el-table-column",{attrs:{label:"章节类型",align:"center",prop:"chapterType"}}),r("el-table-column",{attrs:{label:"章节模式",align:"center",prop:"chapterMode"}}),r("el-table-column",{attrs:{label:"章节字数",align:"center",prop:"chapterSize"}}),r("el-table-column",{attrs:{align:"right",width:"250"},scopedSlots:t._u([{key:"header",fn:function(e){return[r("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})]}},{key:"default",fn:function(e){return[r("el-button",{attrs:{size:"mini"}},[t._v("编辑")]),r("el-button",{attrs:{size:"mini",type:"danger"}},[t._v("添加气泡")])]}}])})],1)],1),r("div",{staticClass:"fr mx-create-center-right"},[r("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[r("el-form-item",{attrs:{label:"导入作品名称:"}},[r("el-autocomplete",{staticClass:"inline-input samll-width",attrs:{"fetch-suggestions":t.queryProjectFn,placeholder:"请输入内容","trigger-on-focus":!1},on:{select:function(e){t.selectProjectFn(e,"insert")}},model:{value:t.insertProjectName,callback:function(e){t.insertProjectName=e},expression:"insertProjectName"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:t.insertProjectFn}},[t._v("导入")])],1)],1),r("el-table",{staticStyle:{width:"100%"},attrs:{data:t.insertList,border:""}},[r("el-table-column",{attrs:{label:"导入文件名称",prop:"fileName"}}),r("el-table-column",{attrs:{label:"导入状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",{staticStyle:{color:"red"},domProps:{textContent:t._s(t.insertState[e.row.state])}})]}}])}),r("el-table-column",{attrs:{align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["failure"==e.row.state?r("el-button",{attrs:{size:"mini",type:"danger"}},[t._v("重试")]):t._e(),-1!=e.row.fileName.indexOf("chapterinfo")?r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){t.lookChaterListFn()}}},[t._v("查看章节列表")]):t._e()]}}])},[r("template",{slot:"header"},[t._v("操作")])],2)],1)],1),r("transition",{attrs:{name:"el-zoom-in-center"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:t.isInsertChapterList,expression:"isInsertChapterList"}],staticClass:"mx-create-chapterLayer",on:{click:t.closeLayer}},[r("div",{staticClass:"chapterLayer-content",on:{click:function(t){t.stopPropagation()}}},[r("el-button",{staticClass:"all-insertChapterList",attrs:{type:"primary"},on:{click:t.allInsertCurrentChapterFn}},[t._v("全部导入")]),r("el-table",{staticStyle:{width:"100%"},attrs:{data:t.insertChapterList,border:""}},[r("el-table-column",{attrs:{label:"章节名称",prop:"chapter_name"}}),r("el-table-column",{attrs:{label:"章节类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",{domProps:{textContent:t._s(t.chapterType[e.row.chapter_type])}})]}}])}),r("el-table-column",{attrs:{label:"章节模式",prop:"fileName"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",{domProps:{textContent:t._s(t.chapterMode[e.row.chapter_mode])}})]}}])}),r("el-table-column",{attrs:{label:"章节字数",prop:"chapter_words"}}),r("el-table-column",{attrs:{label:"导入状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",{staticStyle:{color:"red"},domProps:{textContent:t._s(t.insertState[e.row.chapter_state])}})]}}])}),r("el-table-column",{attrs:{align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(r){t.insertCurrentChapterFn(e.row)}}},[t._v("导入")])]}}])},[r("template",{slot:"header"},[t._v("操作")])],2)],1)],1)])])],1)])},ot=[],ct=(r("96cf"),r("3b8d")),lt={created:function(){this.init()},data:function(){return{queryProjectName:"",queryProjectId:0,insertProjectName:"",insertProjectId:0,chapterType:["初始","普通","结局"],chapterMode:["","网聊","半身像","胸像模式"],chapterList:[{chapterName:"第一章节",chapterType:"普通章节",chapterMode:"网聊模式",chapterSize:"字数"}],insertList:[{fileName:"workinfo.bin",state:"成功",chapterAllList:null}],insertState:{no:"未导入",load:"正在导入中....",success:"成功",failure:"失败",contentNull:"未上传创作区文件"},insertChapterList:[{chapter_id:"e39e00c0a331e89e",chapter_name:"网聊模式",chapter_type:0,chapter_words:22,chapter_expression:{s_id:1}}],isInsertChapterList:!1,newChapterId:null,search:""}},methods:{init:function(){this.chapterList=[],this.insertList=[],this.chapterList=[],this.insertChapterList=[]},initData:function(){this.queryProjectId="06be0534638a4feb92fb3e056fcba4ee",this.queryProjectName="书圣模板",this.insertProjectId="f65eaf4b606a478e8aece4a00dd1fb4d",this.insertProjectName="导入书圣数据"},queryProjectFn:function(t,e){t&&""!=t&&W(t).then(function(t){var r=t.data,a=[];r.isOk&&r.data&&r.data.length&&(a=r.data.map(function(t){return{value:t.work_name+"  ["+t.username+"]",projectId:t.project_id}})),e(a)})},selectProjectFn:function(t,e){"query"==e?this.queryProjectId=t.projectId:this.insertProjectId=t.projectId,console.log("queryProjectId:"+this.queryProjectId+"====insertProjectId:"+this.insertProjectId)},queryChapterFn:function(){var t=this,e=this.chapterType,r=this.chapterMode,a=L()(["chapterinfo.bin"]);this.getInsertProjectInfoFn(a,function(a){var n=t.packDataFn(a.data)[0];if(n&&n.chapter_list&&n.chapter_list.length){var i=n.chapter_list,s=[];i.forEach(function(t){s.push({chapterName:t.chapter_name,chapterType:e[t.chapter_type],chapterMode:r[t.chapter_expression.s_id],chapterSize:t.chapter_words})}),t.chapterList=s}})},insertProjectFn:function(){var t=this,e=L()(["workinfo.bin","filemap.bin","rolelist.bin","values.bin","chapterinfo.bin"]);this.getInsertProjectInfoFn(e,function(e){var r=[];t.newChapterId=Date.parse(new Date);var a=e.data;a&&a.length&&(r=a.map(function(t){return{structureName:t.structureName,data:"v3"==t.materialVer?t.structureContent_v3:t.structureContent}}),t.insertList=[],t.queueInsertData(r))})},queueInsertData:function(){var t=Object(ct["a"])(regeneratorRuntime.mark(function t(e){var r,a,n,i,s=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:r={},a="",n=regeneratorRuntime.mark(function t(n){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=e[n].structureName,r={fileName:a,state:"load"},-1!=a.indexOf("chapterinfo")&&(i=JSON.parse(e[n].data),i.chapter_list.forEach(function(t,e){t.chapter_id=t.chapter_id+"_"+s.newChapterId,t.end_setting&&t.end_setting.end_condition_list.length&&s.ut_updateCondtionChapterId(t.end_setting.end_condition_list)}),e[n].data=L()(i),r.chapterAllList=e[n].data),s.insertList.push(r),t.next=6,s.insertData(a,e[n].data,function(t,r,i){t?r.data.isOk&&s.delayedTime(function(){-1!=a.indexOf("chapterinfo")&&s.bindChapterList(e[n].data),s.insertList[s.insertList.length-1].state="success",i()}):s.delayedTime(function(){s.insertList[s.insertList.length-1].state="failure",s.ut_showMessage("error","dataRenewFailure"),i()})});case 6:case"end":return t.stop()}},t,this)}),t.t0=regeneratorRuntime.keys(e);case 4:if((t.t1=t.t0()).done){t.next=9;break}return i=t.t1.value,t.delegateYield(n(i),"t2",7);case 7:t.next=4;break;case 9:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),appendChapterInfoFn:function(t){var e=this;return new O.a(function(r,a){e.getInsertProjectInfoFn("['chapterinfo.bin']",function(a){var n=e.packDataFn(a.data)[0].chapter_list;t.concat(n),r()},e.insertProjectId)})},insertData:function(t,e,r){var a=this;return e=this.resetProjectIdFn(e),new O.a(function(n,i){G(a.insertProjectId,t,e).then(function(t){t.data.isOk?r&&r(t.data.isOk,t,n):(a.ut_showMessage("error",t.data.message.title),r&&r(!1,null,i))}).catch(function(t){r&&r(!1,null,i),a.ut_showMessage("error","dataRenewFailure"),console.log("数据恢复失败原因",t)})})},getInsertProjectInfoFn:function(t,e){var r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.queryProjectId;Y(a,t).then(function(t){var a=t.data;a.isOk?e(a):a.isOk||2010!=a.message.code?r.ut_showMessage("error",a.message.title):e(!1)}).catch(function(t){console.log("数据获取失败",t)})},bindChapterList:function(t){this.insertChapterList=JSON.parse(t).chapter_list.map(function(t){return{chapter_id:t.chapter_id,chapter_name:t.chapter_name,chapter_type:t.chapter_type,chapter_words:t.chapter_words,chapter_mode:t.chapter_expression.s_id,chapter_state:"no"}})},lookChaterListFn:function(){this.isInsertChapterList=!0},closeLayer:function(){this.isInsertChapterList=!1},insertCurrentChapterFn:function(t){var e=this;t.chapter_state="load";var r="['chapter_".concat(t.chapter_id.split("_")[0],".bin']"),a="chapter_".concat(t.chapter_id,".bin");return new O.a(function(n,i){e.getInsertProjectInfoFn(r,function(r){var s=e.ut_newCreateChapterContent(e.resetProjectIdFn(e.packDataFn(r.data)[0]));if(!s)return e.delayedTime(function(){t.chapter_state="contentNull"}),void n();e.insertData(a,s,function(r,a,s){s(),r?(e.delayedTime(function(){t.chapter_state="success"}),n()):(e.delayedTime(function(){t.chapter_state="failure"}),i())})})})},allInsertCurrentChapterFn:function(){var t=Object(ct["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:t.t0=regeneratorRuntime.keys(this.insertChapterList);case 1:if((t.t1=t.t0()).done){t.next=7;break}return e=t.t1.value,t.next=5,this.insertCurrentChapterFn(this.insertChapterList[e]);case 5:t.next=1;break;case 7:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),resetProjectIdFn:function(t){return!!t&&(t="string"==typeof t?JSON.parse(t):t,t.last_chapter_id&&-1==t.last_chapter_id.indexOf(this.newChapterId)&&(t.last_chapter_id=t.last_chapter_id+"_"+this.newChapterId),t.work_name&&(t.work_name=this.insertProjectName),t.chapter_id&&-1==t.chapter_id.indexOf(this.newChapterId)&&(t.chapter_id=t.chapter_id+"_"+this.newChapterId),t.project_id=this.insertProjectId,t)},delayedTime:function(t){setTimeout(function(){t&&t()},150)},packDataFn:function(t){if(!t)return[];var e=t.map(function(t){return"v3"==t.materialVer?JSON.parse(t.structureContent_v3):JSON.parse(t.structureContent)});return e},ut_newCreateChapterContent:function(t){var e=this;return t.cmd_sequence_list&&t.cmd_sequence_list.length?(t.cmd_sequence_list.map(function(t){105==t.cmd_event.code||130==t.cmd_event.code?t.cmd_event.argv.data.forEach(function(t){e.ut_updateCondtionChapterId(t.conditions),t.sequence_list.forEach(function(t){e.ut_updateChapterId(t)})}):e.ut_updateChapterId(t)}),t):t},ut_updateChapterId:function(t){var e=this;t.cmd_list&&t.cmd_list.length&&t.cmd_list.map(function(t){118==t.code&&t.argv.data.map(function(t){t.sequence_list[0].argv.id=t.sequence_list[0].argv.id+"_"+e.newChapterId}),116==t.code&&(t.argv.id=t.argv.id+"_"+e.newChapterId)})},ut_updateCondtionChapterId:function(t){var e=this;t.forEach(function(t){t.var_operate&&13==t.var_operate.c_type&&(t.var_operate.c_value=t.var_operate.c_value+"_"+e.newChapterId),t.var_operated&&13==t.var_operated.c_type&&(t.var_operated.c_value=t.var_operated.c_value+"_"+e.newChapterId)})}}},ut=lt,pt=(r("7a7e"),Object(u["a"])(ut,st,ot,!1,null,"611e60a3",null));pt.options.__file="mxCreate.vue";var ht=pt.exports,dt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"v_aboutUs"},[a("el-carousel",{staticClass:"aboutUs-carousel",attrs:{interval:4e3,type:"card",height:"300px"}},t._l(4,function(t){return a("el-carousel-item",{key:t},[a("img",{attrs:{src:r("4b2c")}})])}),1)],1)},ft=[],mt=(r("c94e"),{}),_t=Object(u["a"])(mt,dt,ft,!1,null,"e709c962",null);_t.options.__file="aboutUs.vue";var bt=_t.exports,vt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"mx-preview-right"},[r("pb-header",{attrs:{isLeft:!1}},[r("span",{attrs:{slot:"title"},domProps:{textContent:t._s(t.getProjectName)},slot:"title"})])],1)},gt=[],wt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"v_header"},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:6}},[t.isLeft?r("div",{staticClass:"header-left"},[t._t("left",[r("span",{on:{click:t.returnPageFn}},[t._v("返回")])])],2):r("div",{staticStyle:{opacity:"0"}},[t._v(".")])]),r("el-col",{attrs:{span:12}},[r("div",{staticClass:"header-title"},[t._t("title",[t._v("详情页")])],2)]),t.isRight?r("el-col",{attrs:{span:6}},[r("div",{staticClass:"header-right"},[t._t("right",[t._v("  恢复数据")])],2)]):t._e()],1),r("div",{staticClass:"header-pleacholder"})],1)},xt=[],jt={props:{isLeft:{type:Boolean,default:!0},isRight:{type:Boolean,default:!1}},methods:{returnPageFn:function(){this.$router.go(-1)}}},Ct=jt,yt=(r("d4c1"),Object(u["a"])(Ct,wt,xt,!1,null,null,null));yt.options.__file="pb_header.vue";var kt=yt.exports,It={components:{pbHeader:kt},computed:Object(s["a"])({},Object(o["b"])(["getProjectName"])),data:function(){return{}},methods:{}},Nt=It,Pt=(r("66f4"),Object(u["a"])(Nt,vt,gt,!1,null,null,null));Pt.options.__file="preview.vue";var St=Pt.exports,Lt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"V_mxTest"},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("el-button",{staticClass:"fl mb20",attrs:{type:"primary"},on:{click:t.fn_addProject}},[t._v("添加作品")]),r("el-table",{staticStyle:{width:"100%"},attrs:{data:t.dt_projectList,border:""}},[r("el-table-column",{attrs:{label:"作品名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-autocomplete",{staticClass:"inline-input medium-width medium-input",attrs:{placeholder:"请输入作品名称","trigger-on-focus":!1,"fetch-suggestions":t.fn_querySearch},on:{select:function(r){return t.fn_selectProject(r,e)}},model:{value:e.row.projectName,callback:function(r){t.$set(e.row,"projectName",r)},expression:"scope.row.projectName"}})]}}])}),r("el-table-column",{attrs:{label:"选择章节"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-select",{staticClass:"medium-input",attrs:{size:"medium",placeholder:"请选择"},on:{change:function(r){t.fn_selectChapter(e.row)}},model:{value:e.row.chapterId,callback:function(r){t.$set(e.row,"chapterId",r)},expression:"scope.row.chapterId"}},t._l(e.row.chapterList,function(t){return r("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)]}}])}),r("el-table-column",{attrs:{width:"140",label:"发布状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["no"==e.row.xhrState?r("el-tag",{attrs:{type:"info"},domProps:{textContent:t._s(t.dt_xhrState["no"])}},[t._v("未保存")]):t._e(),"load"==e.row.xhrState?r("el-tag",{domProps:{textContent:t._s(t.dt_xhrState["load"])}},[t._v("保存中")]):t._e(),"success"==e.row.xhrState?r("el-tag",{attrs:{type:"success"},domProps:{textContent:t._s(t.dt_xhrState["success"])}},[t._v("保存成功")]):t._e(),"failure"==e.row.xhrState||"contentNull"==e.row.xhrState?r("el-tag",{attrs:{type:"danger"},domProps:{textContent:t._s(t.dt_xhrState[e.row.xhrState])}},[t._v("保存失败")]):t._e()]}}])}),r("el-table-column",{attrs:{width:"120",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(r){t.fn_deleteRow(e.$index)}}},[t._v("删除")])]}}])})],1)],1),r("el-col",{staticClass:"mxTest-right fr",attrs:{span:6}},[r("div",{staticClass:"mxTest-right-title mb20 "},[r("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.fn_batchSaveChaper}},[t._v("保存章节")])],1),r("el-form",{staticClass:"form-newClass",attrs:{"label-width":"100px"}},[r("el-form-item",{attrs:{label:"选择气泡类型"}},[r("el-select",{attrs:{placeholder:"请选择活动区域"},model:{value:t.dt_bubbleType,callback:function(e){t.dt_bubbleType=e},expression:"dt_bubbleType"}},t._l(t.dt_coreBubble,function(t){return r("el-option",{key:t.value,attrs:{label:t.label,value:t.value,disabled:t.disabled}})}),1)],1),r("el-form-item",{attrs:{label:"输入内容"}},[r("el-input",{attrs:{type:"textarea"},model:{value:t.dt_bubbleContent,callback:function(e){t.dt_bubbleContent=e},expression:"dt_bubbleContent"}})],1)],1)],1)],1)],1)},Ft=[],Ot=r("5176"),Dt=r.n(Ot),Rt=r("e814"),qt=r.n(Rt),Tt=r("7618"),Mt={cloneCopy:function(t){var e;if(!t)return t;for(var r in e=t.constructor==Object?new t.constructor:new t.constructor(t.valueOf()),t)e[r]!==t[r]&&("object"==Object(Tt["a"])(t[r])?t[r]instanceof Array?e[r]=t[r].length?this.cloneCopy(t[r]):[]:e[r]=this.cloneCopy(t[r]):e[r]=t[r]);return e},createId:function(){var t=new Date,e=qt()((899999*Math.random()).toString())+1e5;return this.MD5(t.toString()+e.toString(),16)},MD5:function(t,e){var r=t;function a(t,e){return t<<e|t>>>32-e}function n(t,e){var r,a,n,i,s;return n=2147483648&t,i=2147483648&e,r=1073741824&t,a=1073741824&e,s=(1073741823&t)+(1073741823&e),r&a?2147483648^s^n^i:r|a?1073741824&s?3221225472^s^n^i:1073741824^s^n^i:s^n^i}function i(t,e,r){return t&e|~t&r}function s(t,e,r){return t&r|e&~r}function o(t,e,r){return t^e^r}function c(t,e,r){return e^(t|~r)}function l(t,e,r,s,o,c,l){return t=n(t,n(n(i(e,r,s),o),l)),n(a(t,c),e)}function u(t,e,r,i,o,c,l){return t=n(t,n(n(s(e,r,i),o),l)),n(a(t,c),e)}function p(t,e,r,i,s,c,l){return t=n(t,n(n(o(e,r,i),s),l)),n(a(t,c),e)}function h(t,e,r,i,s,o,l){return t=n(t,n(n(c(e,r,i),s),l)),n(a(t,o),e)}function d(t){var e,r=t.length,a=r+8,n=(a-a%64)/64,i=16*(n+1),s=Array(i-1),o=0,c=0;while(c<r)e=(c-c%4)/4,o=c%4*8,s[e]=s[e]|t.charCodeAt(c)<<o,c++;return e=(c-c%4)/4,o=c%4*8,s[e]=s[e]|128<<o,s[i-2]=r<<3,s[i-1]=r>>>29,s}function f(t){var e,r,a="",n="";for(r=0;r<=3;r++)e=t>>>8*r&255,n="0"+e.toString(16),a+=n.substr(n.length-2,2);return a}var m,_,b,v,g,w,x,j,C,y=Array(),k=7,I=12,N=17,P=22,S=5,L=9,F=14,O=20,D=4,R=11,q=16,T=23,M=6,$=10,V=15,z=21;for(y=d(r),w=1732584193,x=4023233417,j=2562383102,C=271733878,m=0;m<y.length;m+=16)_=w,b=x,v=j,g=C,w=l(w,x,j,C,y[m+0],k,3614090360),C=l(C,w,x,j,y[m+1],I,3905402710),j=l(j,C,w,x,y[m+2],N,606105819),x=l(x,j,C,w,y[m+3],P,3250441966),w=l(w,x,j,C,y[m+4],k,4118548399),C=l(C,w,x,j,y[m+5],I,1200080426),j=l(j,C,w,x,y[m+6],N,2821735955),x=l(x,j,C,w,y[m+7],P,4249261313),w=l(w,x,j,C,y[m+8],k,1770035416),C=l(C,w,x,j,y[m+9],I,2336552879),j=l(j,C,w,x,y[m+10],N,4294925233),x=l(x,j,C,w,y[m+11],P,2304563134),w=l(w,x,j,C,y[m+12],k,1804603682),C=l(C,w,x,j,y[m+13],I,4254626195),j=l(j,C,w,x,y[m+14],N,2792965006),x=l(x,j,C,w,y[m+15],P,1236535329),w=u(w,x,j,C,y[m+1],S,4129170786),C=u(C,w,x,j,y[m+6],L,3225465664),j=u(j,C,w,x,y[m+11],F,643717713),x=u(x,j,C,w,y[m+0],O,3921069994),w=u(w,x,j,C,y[m+5],S,3593408605),C=u(C,w,x,j,y[m+10],L,38016083),j=u(j,C,w,x,y[m+15],F,3634488961),x=u(x,j,C,w,y[m+4],O,3889429448),w=u(w,x,j,C,y[m+9],S,568446438),C=u(C,w,x,j,y[m+14],L,3275163606),j=u(j,C,w,x,y[m+3],F,4107603335),x=u(x,j,C,w,y[m+8],O,1163531501),w=u(w,x,j,C,y[m+13],S,2850285829),C=u(C,w,x,j,y[m+2],L,4243563512),j=u(j,C,w,x,y[m+7],F,1735328473),x=u(x,j,C,w,y[m+12],O,2368359562),w=p(w,x,j,C,y[m+5],D,4294588738),C=p(C,w,x,j,y[m+8],R,2272392833),j=p(j,C,w,x,y[m+11],q,1839030562),x=p(x,j,C,w,y[m+14],T,4259657740),w=p(w,x,j,C,y[m+1],D,2763975236),C=p(C,w,x,j,y[m+4],R,1272893353),j=p(j,C,w,x,y[m+7],q,4139469664),x=p(x,j,C,w,y[m+10],T,3200236656),w=p(w,x,j,C,y[m+13],D,681279174),C=p(C,w,x,j,y[m+0],R,3936430074),j=p(j,C,w,x,y[m+3],q,3572445317),x=p(x,j,C,w,y[m+6],T,76029189),w=p(w,x,j,C,y[m+9],D,3654602809),C=p(C,w,x,j,y[m+12],R,3873151461),j=p(j,C,w,x,y[m+15],q,530742520),x=p(x,j,C,w,y[m+2],T,3299628645),w=h(w,x,j,C,y[m+0],M,4096336452),C=h(C,w,x,j,y[m+7],$,1126891415),j=h(j,C,w,x,y[m+14],V,2878612391),x=h(x,j,C,w,y[m+5],z,4237533241),w=h(w,x,j,C,y[m+12],M,1700485571),C=h(C,w,x,j,y[m+3],$,2399980690),j=h(j,C,w,x,y[m+10],V,4293915773),x=h(x,j,C,w,y[m+1],z,2240044497),w=h(w,x,j,C,y[m+8],M,1873313359),C=h(C,w,x,j,y[m+15],$,4264355552),j=h(j,C,w,x,y[m+6],V,2734768916),x=h(x,j,C,w,y[m+13],z,1309151649),w=h(w,x,j,C,y[m+4],M,4149444226),C=h(C,w,x,j,y[m+11],$,3174756917),j=h(j,C,w,x,y[m+2],V,718787259),x=h(x,j,C,w,y[m+9],z,3951481745),w=n(w,_),x=n(x,b),j=n(j,v),C=n(C,g);return 32==e?f(w)+f(x)+f(j)+f(C):f(x)+f(j)}},$t=Mt,Vt={created:function(){this.init()},data:function(){return{dt_projectList:[],dt_projectItem:{projectName:"",projectId:"",chapterId:"",chapterList:[],chapterContent:"",xhrState:"no"},dt_coreBubble:[{value:111,label:"中气泡"},{value:110,label:"CG"},{value:112,label:"旁白"},{value:100,label:"角色气泡",disabled:!0}],dt_bubbleType:111,dt_bubbleContent:"泰多测试并发添加数据",dt_xhrState:{no:"未保存",load:"正在保存中....",success:"保存成功",failure:"保存失败",contentNull:"创作区文件未上传"},dt_loading:null}},computed:Object(s["a"])({},Object(o["b"])(["getApiVersion"])),methods:{init:function(){this.initFn()},initData:function(){},initFn:function(){this.fn_defultProjectData()},fn_defultProjectData:function(){var t=this;if("test"==this.getApiVersion){var e=[{projectId:"d5ab4e08f34a4a97ae8a0eac4b41b205",projectName:"泰多压力测试丢数据",default:!0},{projectId:"2a00abf79869447dab04fcffd418a550",projectName:"泰多压力测试数据问题2",default:!0},{projectId:"164462301ee242d9896281a5f32e7a1e",projectName:"泰多压力测试数据问题3",default:!0},{projectId:"64b5349b785949b2a620625ef6200558",projectName:"泰多压力测试数据问题4",default:!0},{projectId:"402810e0833746899a86f3734b922b04",projectName:"泰多压力测试数据问题5",default:!0},{projectId:"07180cad46ea4a6a8958cb9cf649e024",projectName:"泰多压力测试数据问题6",default:!0},{projectId:"2d91c15d1c6742fb9d28002670609097",projectName:"泰多压力测试数据问题7",default:!0},{projectId:"b495234220064d3787e956e225542ae1",projectName:"泰多压力测试数据问题8",default:!0},{projectId:"2bd16d228cba4f68992f49fd969e2960",projectName:"泰多压力测试数据问题9",default:!0}],r={},a={};e.forEach(function(e){var n=JSON.parse(L()(t.dt_projectItem));n=Dt()(n,e),t.dt_projectList.push(n),r={projectId:e.projectId},a={row:n},t.fn_selectProject(r,a)})}},fn_addProject:function(){this.dt_projectList.push(this.dt_projectItem)},fn_deleteRow:function(t){this.dt_projectList.splice(t,1)},fn_querySearch:function(t,e){t&&""!=t&&W(t).then(function(t){var r=t.data,a=[];r.isOk&&r.data&&r.data.length&&(a=r.data.map(function(t){return{value:t.work_name+"  ["+t.username+"]",projectId:t.project_id}})),e(a)})},fn_selectProject:function(t,e){var r=this;e.row.projectId=t.projectId,this.xhr_getProjectFile(t.projectId,["chapterinfo.bin"],function(t){e.row.chapterName="",e.row.chapterList=[],t.chapter_list.forEach(function(t,a){e.row.chapterList.push({value:t.chapter_id,label:t.chapter_name}),0==a&&(e.row.chapterId=t.chapter_id),0==a&&r.fn_defaultSelectChapter(e.row)})})},xhr_getProjectFile:function(t,e,r){var a=this;Y(t,L()(e)).then(function(t){var n={};e.length>1?t.data.data.map(function(t){var e=-1!=t.structureName.indexOf("chapter_")?"chapterContent":t.structureName.split(".")[0];n[e]=a.ut_handlerChapterData(t)}):n=a.ut_handlerChapterData(t.data.data[0]),r(n)},function(){a.fn_closeLoading()}).catch(function(t){a.fn_closeLoading(),console.log("章节列表获取失败",t),a.ut_showMessage("error","章节列表获取失败")})},ut_handlerChapterData:function(t){if("[object Object]"!=Object.prototype.toString.call(t))return null;var e=null;return e="v3"==t.materialVer?JSON.parse(t.structureContent_v3):JSON.parse(t.structureContent),-1==t.structureName.indexOf("chapter")&&(e=L()(e)),e},fn_selectChapter:function(t){var e=this;this.fn_showLoading();var r=["rolelist.bin","filemap.bin","chapterinfo.bin","chapter_".concat(t.chapterId,".bin")];this.xhr_getProjectFile(t.projectId,r,function(r){t=Dt()(t,r),console.log("row",t),e.fn_closeLoading()})},fn_defaultSelectChapter:function(t){var e=this;this.fn_showLoading();var r=["rolelist.bin","filemap.bin","chapterinfo.bin","chapter_".concat(t.chapterId,".bin")];this.xhr_getProjectFile(t.projectId,r,function(r){t=Dt()(t,r),e.dt_projectList.indexOf(t)>=e.dt_projectList.length-1&&e.fn_closeLoading()})},fn_batchSaveChaper:function(){var t=this;this.dt_projectList.length?this.dt_projectList.forEach(function(e){t.xhr_saveChapter(e)}):this.ut_showMessage("error","没有要保存的作品")},xhr_saveChapter:function(t){if(t.chapterContent){t.xhrState="load",t.chapterContent=this.ut_addChapterData(t.chapterContent);var e=["rolelist.bin","filemap.bin","chapterinfo.bin","chapter_".concat(t.chapterId,".bin")],r=[JSON.parse(t.rolelist),JSON.parse(t.filemap),t.chapterinfo,t.chapterContent];G(t.projectId,e,r).then(function(e){var r=e.data;r.isOk?t.xhrState="success":t.xhrState="failure"},function(){t.xhrState="failure"}).catch(function(e){t.xhrState="failure",console.log("保存数据失败",e)})}else t.xhrState="contentNull"},ut_addChapterData:function(t){if(t)return t.cmd_sequence_list.push(this.ut_createBubbleData()),t},ut_createBubbleData:function(){var t=null;switch(this.dt_bubbleType){case 100:t={cmd_event:{argv:{image_bean_id:"260ce7531b2f36a9",image_id:"roleImg_10488901",mood_id:0,pic_express_id:"",role_id:"e73d3b9b29593bca",text:this.dt_bubbleContent},cmd_key:"show_text",code:100},cmd_list:[],i_id:$t.createId(),s_id:$t.createId()};break;case 111:t={cmd_event:{argv:{text:this.dt_bubbleContent},cmd_key:"show_text_middle",code:111},cmd_list:[],i_id:$t.createId(),s_id:$t.createId()};break;case 110:t={cmd_event:{argv:{text:this.dt_bubbleContent,cg_id:"",text_pos:0},cmd_key:"show_cg",code:110},cmd_list:[],i_id:$t.createId(),s_id:$t.createId()};break;case 112:t={cmd_event:{argv:{text:this.dt_bubbleContent,text_pos:0},cmd_key:"show_aside",code:112},cmd_list:[],i_id:$t.createId(),s_id:$t.createId()};break}return t},fn_showLoading:function(){this.fn_closeLoading(),this.dt_loading=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"})},fn_closeLoading:function(){this.dt_loading&&this.dt_loading.close()}}},zt=Vt,Et=(r("ce52"),Object(u["a"])(zt,Lt,Ft,!1,null,"36e4f528",null));Et.options.__file="mxTest.vue";var At=Et.exports,Bt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"v_chapterDetail"},[r("pb-header",{attrs:{isRight:!0}},[r("span",{attrs:{slot:"left"},on:{click:t.closeFn},slot:"left"},[t._v("返回")]),r("span",{attrs:{slot:"title"},domProps:{textContent:t._s(t.chapter.chapter_name)},slot:"title"}),r("span",{attrs:{slot:"right"},on:{click:t.restoreDataFn},slot:"right"},[t._v("恢复数据")])]),r("section",{staticClass:"v_section"},t._l(t.bubbleList,function(e,a){return 130!=e.code||105!=e.code?r("role-bubble",{attrs:{isRole:100==e.code,roleType:e.code}},[r("span",{attrs:{slot:"title"},domProps:{textContent:t._s(t.bubbleType[e.code])},slot:"title"}),r("span",{attrs:{slot:"content"},domProps:{textContent:t._s(e.argv.text)},slot:"content"})]):t._e()}),1)],1)},Jt=[],Ut=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"v_bubble"},[t.isRole?r("div",{staticClass:"bubble-left"},[r("img",{attrs:{slot:"roleImg",src:"//mxcdn.cgyouxi.com/res_ver3/39/39bcd3686b9e49442eff74987970256f"},slot:"roleImg"}),r("div",{staticClass:"roleType"},[t.roleType?t._t("default",[t._v("主角")]):t._e()],2)]):t._e(),r("div",{staticClass:"bubble-right",class:t.isRole?"right-padding":""},[r("p",{staticClass:"bubble-right-name"},[t.isRole?t._t("userName",[t._v("姓名")]):t._t("title",[t._v("姓名")])],2),r("div",{staticClass:"bubble-right-content"},[t._t("content",[t._v("2222222")])],2)])])},Ht=[],Wt={props:{isRole:{default:!1},roleType:{default:!1}}},Gt=Wt,Yt=(r("fe0d"),Object(u["a"])(Gt,Ut,Ht,!1,null,"40662b19",null));Yt.options.__file="roleBubble.vue";var Kt=Yt.exports,Qt={created:function(){console.log("chapterchapterchapter",this.chapter),this.init()},props:["chapter"],components:{pbHeader:kt,roleBubble:Kt},computed:Object(s["a"])({},Object(o["b"])(["getProjectId"])),data:function(){return{bubbleList:[],bubbleType:{110:"CG",111:"中气泡",112:"旁白"}}},methods:{init:function(){this.initData()},initData:function(){this.chapter&&this.chapter.cmd_sequence_list&&this.chapter.cmd_sequence_list.length&&(this.bubbleList=this.chapter.cmd_sequence_list.map(function(t){return t.cmd_event}))},closeFn:function(){this.$parent.isChapterDetail=!1},restoreDataFn:function(){var t=this;G(this.getProjectId,"chapter_".concat(this.chapter.chapter_id,".bin"),this.chapter).then(function(e){e.data.isOk?t.ut_showMessage("success","dataRenewSuccess"):t.ut_showMessage("error",e.data.message.context)},function(){}).catch(function(e){t.ut_showMessage("error","dataRenewFailure"),console.log("数据恢复失败原因",e)})}}},Xt=Qt,Zt=(r("17cc"),Object(u["a"])(Xt,Bt,Jt,!1,null,null,null));Zt.options.__file="chapterDetail.vue";var te=Zt.exports,ee=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"v_chapterList"},[r("div",{directives:[{name:"show",rawName:"v-show",value:!t.isChapterDetail,expression:"!isChapterDetail"}]},[r("pb-header",{attrs:{isRight:!0}},[r("span",{attrs:{slot:"left"},on:{click:t.closeFn},slot:"left"},[t._v("返回")]),r("span",{attrs:{slot:"title"},domProps:{textContent:t._s("["+t.chapterName+"]发布列表")},slot:"title"}),r("span",{attrs:{slot:"right"},domProps:{textContent:t._s(t.sortNum?"倒序":"正序")},on:{click:t.sortFn},slot:"right"},[t._v("正序")])]),r("section",{staticClass:"preview-chapterList"},t._l(t.chapterList,function(e,a){return r("div",{staticClass:"preview-chapterList-item",on:{click:function(r){t.skipChapterDetailFn(e)}}},[r("div",[r("span",{domProps:{textContent:t._s(t.chapterType[e.chapter_type])}},[t._v("普通")]),r("span",{domProps:{textContent:t._s(e.chapter_name)}},[t._v("章节1")]),r("span",{staticClass:"fr"},[t._v("发布版本:"),r("font",{staticStyle:{color:"red"}},[t._v(t._s([e.sortIndex]))])],1)]),r("div",{class:2==e.chapter_expression.s_id?"chapter-bsx":3==e.chapter_expression.s_id?"chapter-xx":""},[r("span",{domProps:{textContent:t._s(t.chapterMode[e.chapter_expression.s_id])}},[t._v("网聊")]),r("span",{domProps:{textContent:t._s(e.chapter_words+"字")}},[t._v("4字")])]),r("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(r){r.stopPropagation(),t.restoreDataFn(e)}}},[t._v("数据恢复")])],1)}),0)],1),t.isChapterDetail?r("chapter-detail",{attrs:{chapter:t.chapter}}):t._e()],1)},re=[],ae={created:function(){this.init()},components:{pbHeader:kt,chapterDetail:te},props:["chapterItem"],computed:Object(s["a"])({},Object(o["b"])({projectNumber:"getProjectNumber",projectId:"getProjectId"})),data:function(){return{componentName:"",chapterList:[],chapterType:["初始","普通","结局"],chapterMode:["网聊","半身像","胸像模式"],chapterId:0,chapterName:"",isChapterDetail:!1,chapter:{},sortNum:0}},methods:{init:function(){var t=this.chapterItem;this.chapterId=t.chapterId,this.chapterName=t.chapterName,this.initRequest()},initRequest:function(){var t=Object(ct["a"])(regeneratorRuntime.mark(function t(){var e,r,a,n=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e=[],this.activeName+".bin",r=regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,H(n.projectId,r,"chapter_".concat(n.chapterId,".bin")).then(function(t){t.data.sortIndex=r,e.push(t.data),r==n.projectNumber&&(n.chapterList=e)}).catch(function(t){});case 2:case"end":return t.stop()}},t,this)}),a=1;case 4:if(!(a<=this.projectNumber)){t.next=9;break}return t.delegateYield(r(a),"t0",6);case 6:a++,t.next=4;break;case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),closeFn:function(){this.$parent.isChapterItemList=!1},restoreDataFn:function(t){var e=this;G(this.projectId,"chapter_".concat(this.chapterId,".bin"),t).then(function(t){t.data.isOk?e.ut_showMessage("success","dataRenewSuccess"):e.ut_showMessage("error",t.data.message.context)}).catch(function(t){e.ut_showMessage("error","dataRenewFailure"),console.log("数据恢复失败原因",t)})},skipChapterDetailFn:function(t){this.chapter=t,this.isChapterDetail=!0},sortFn:function(){this.sortNum=this.sortNum?0:1,this.chapterList.reverse()}}},ne=ae,ie=(r("50ae"),Object(u["a"])(ne,ee,re,!1,null,"7e874333",null));ie.options.__file="chapterItemList.vue";var se=ie.exports,oe=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"mx-preview-right"},[t.isChapterDetail?t._e():r("div",[r("pb-header",{attrs:{isLeft:!1,isRight:t.chapterNumber>0}},[r("span",{attrs:{slot:"title"},domProps:{textContent:t._s(t.getProjectName)},slot:"title"}),r("span",{attrs:{slot:"right"},on:{click:t.allRestoreDataFn},slot:"right"},[t._v("全部恢复")])]),r("header",{staticClass:"preview-header"},[r("span",[t._v("章节数:"),r("font",{domProps:{textContent:t._s(t.chapterNumber)}},[t._v("3")])],1),r("span",[t._v("作品字数:"),r("font",{domProps:{textContent:t._s(t.chapterSize)}},[t._v("3")])],1)]),r("section",{staticClass:"preview-chapterList"},t._l(t.chapterList,function(e,a){return r("div",{staticClass:"preview-chapterList-item",on:{click:function(r){t.skipChapterDetailFn(e)}}},[r("div",[r("span",{domProps:{textContent:t._s(t.chapterType[e.chapter_type])}},[t._v("普通")]),r("span",{domProps:{textContent:t._s(e.chapter_name)}},[t._v("章节1")]),"succeed"==e.puhlishState?r("el-tag",{staticClass:"publishState",attrs:{size:"small",type:"success"},domProps:{textContent:t._s(t.restoreState[e.puhlishState])}}):t._e(),"failure"==e.puhlishState?r("el-tag",{staticClass:"publishState",attrs:{size:"small",type:"danger"},domProps:{textContent:t._s(t.restoreState[e.puhlishState])}}):t._e()],1),r("div",{class:2==e.chapter_expression.s_id?"chapter-bsx":3==e.chapter_expression.s_id?"chapter-xx":""},[r("span",{domProps:{textContent:t._s(t.chapterMode[e.chapter_expression.s_id])}},[t._v("网聊")]),r("span",{domProps:{textContent:t._s(e.chapter_words+"字")}},[t._v("4字")])])])}),0),t.chapterNumber<=0?r("div",{staticStyle:{"text-align":"center","margin-top":"30px"}},[t._v("\n            章节数据全部丢失 请联系程序员\n        ")]):t._e()],1),t.isChapterDetail?r("chapter-detail",{attrs:{chapter:t.chapter}}):t._e()],1)},ce=[],le={created:function(){this.init()},components:{pbHeader:kt,chapterDetail:te},computed:Object(s["a"])({},Object(o["b"])(["getProjectName","getProjectNumber","getProjectId"])),data:function(){return{chapterList:[],chapterSize:0,chapterNumber:0,chapterType:["初始","普通","结局"],chapterMode:["","网聊","半身像","胸像模式"],chapterId:0,chapterName:"",isChapterDetail:!1,chapter:{},restoreState:{succeed:"恢复成功",failure:"恢复失败"},currentChapterVersion:0}},watch:{$route:"init"},methods:{init:function(){this.initData();var t=this.$route.params,e=t.data;if(e&&e.chapter_list.length){this.currentChapterVersion=t.version;var r=e.chapter_list;this.chapterNumber=r.length,this.chapterSize=r.reduce(function(t,e){return t=void 0==t?0:"object"==Object(Tt["a"])(t)?t.chapter_words:t,qt()(t)+qt()(e.chapter_words)}),this.chapterSize="object"==Object(Tt["a"])(this.chapterSize)?this.chapterSize.chapter_words:this.chapterSize,this.chapterList=r}},initData:function(){this.isChapterDetail=!1,this.chapterList=[],this.chapterSize=0,this.chapterNumber=0},chapterAddProperty:function(t){return chater},skipChapterDetailFn:function(t){var e=this;this.getCurrentChpaterContentFn(t.chapter_id,function(t){t?(e.chapter=t,e.isChapterDetail=!0):e.ut_showMessage("error","作者章节内容未发布")})},getCurrentChpaterContentFn:function(t,e){H(this.getProjectId,this.currentChapterVersion,"chapter_".concat(t,".bin")).then(function(t){e(t.data)}).catch(function(t){e(!1)})},allRestoreDataFn:function(){var t=this;this.chapterList.forEach(function(e){t.getCurrentChpaterContentFn(e.chapter_id,function(r){r?t.restoreDataFn(e,r):(t.ut_showMessage("error","".concat(e.chapter_name,"章节内容没有发布过")),t.restoreStateBind("failure",e))})})},restoreDataFn:function(t,e){var r=this;G(this.getProjectId,"chapter_".concat(t.chapter_id,".bin"),e).then(function(e){e.data.isOk?r.restoreStateBind("succeed",t):r.restoreStateBind("failure",t)},function(){r.restoreStateBind("failure",t)}).catch(function(e){r.restoreStateBind("failure",t),r.ut_showMessage("error","dataRenewFailure"),console.log("数据恢复失败原因",e)})},restoreStateBind:function(t,e){switch(t){case"succeed":this.$set(e,"puhlishState","succeed");break;case"failure":this.$set(e,"puhlishState","failure");break}}}},ue=le,pe=(r("120d"),Object(u["a"])(ue,oe,ce,!1,null,null,null));pe.options.__file="chapterList.vue";var he=pe.exports,de=[{path:"/",component:I},{name:"login",path:"/login",component:Z},{path:"/mx",component:it,redirect:"/mx/preveiw",children:[{name:"preveiw",path:"preveiw",component:St},{name:"chapterList",path:"chapterList",component:he},{name:"chapterItemList",path:"chapterItemList",component:se}]},{path:"/mxCreate",component:ht},{name:"mxtest",path:"/mxTest",component:At},{path:"/about",component:bt}],fe=de;a["default"].use(w["a"]);var me=new w["a"]({routes:fe,mode:"history",scrollBehavior:function(t,e,r){return r||{x:0,y:0}}});me.beforeEach(function(t,e,r){g.getters.getLoginState||"login"==t.name?r():($("error","未登录 请先登陆！"),r({path:"/login"}))});var _e=me;a["default"].use(f.a),a["default"].prototype.axios=R.a,a["default"].prototype.ut_showMessage=$,a["default"].config.productionTip=!1,new a["default"]({store:g,router:_e,render:function(t){return t(h)}}).$mount("#app")},5735:function(t,e,r){},"5f52":function(t,e,r){},"64a9":function(t,e,r){},"66f4":function(t,e,r){"use strict";var a=r("dc76"),n=r.n(a);n.a},"7a7e":function(t,e,r){"use strict";var a=r("269d"),n=r.n(a);n.a},c94e:function(t,e,r){"use strict";var a=r("4516"),n=r.n(a);n.a},ca3e:function(t,e,r){"use strict";var a=r("0514"),n=r.n(a);n.a},ce21:function(t,e,r){"use strict";var a=r("5f52"),n=r.n(a);n.a},ce52:function(t,e,r){"use strict";var a=r("d08e"),n=r.n(a);n.a},d08e:function(t,e,r){},d15b:function(t,e,r){},d15f:function(t,e,r){t.exports=r.p+"img/banner1.925243a6.jpg"},d25d:function(t,e,r){},d4c1:function(t,e,r){"use strict";var a=r("5735"),n=r.n(a);n.a},db49:function(t,e,r){t.exports=r.p+"img/banner2.366abc21.jpg"},dc76:function(t,e,r){},ea85:function(t,e,r){},fe0d:function(t,e,r){"use strict";var a=r("ea85"),n=r.n(a);n.a}});
//# sourceMappingURL=app.54c9be58.js.map